# 先着予約システム実行ファイル 使用ガイド【Windows限定】

## 0. はじめに
このドキュメントは、**「情報入力.exe」と「予約実行.exe」**という2つの実行ファイルを初めて使用する方に向けて、正しい操作手順と注意事項を説明するためのものです。  
「情報入力.exe」: ユーザー情報と予約情報を入力し、保存するプログラムです。  
「予約実行.exe」: 保存された情報をもとに予約を自動で実行するプログラムです。

## 1. ファイルの目的
以下の2つの作業を自動化するためです。  
- 早起き：毎月13日の早起きをしなくてよいようにする  
- 先着予約の定期確認：定期的に先着予約をするのを自動化する。  

「タスクスケジューラ」と今回のアプリを使うと、上2つを自動化できます。  
※説明書の残りを読んで、誤作動がないように気を付けてください。  
タスクスケジューラについては以下を参照。  
[タスクスケジューラにexeファイルを登録する方法](https://rbelgblog.com/blog/2023/02/23/%E3%82%BF%E3%82%B9%E3%82%AF%E3%82%B9%E3%82%B1%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%A9%E3%81%ABexe%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E7%99%BB%E9%8C%B2%E3%81%97%E3%81%A6%E5%AE%9A%E6%9C%9F/)

## 2. 前提条件
### 動作環境
- 対応OS: Windows 10 以降  
- メモリ: 4GB以上を推奨  
- ディスク空き容量: 100MB以上  

### 必要なソフトウェア
追加のソフトウェアは不要です。配布されるファイルのみで実行可能です。

## 3. ファイル構成
配布されるファイルには次のものが含まれています。  
- 「情報入力.exe」: ユーザー情報や予約情報を入力するためのプログラム  
- 「予約実行.exe」: 予約を実行するためのプログラム  
- `reservation.db`: 保存されたデータを管理するデータベースファイル  
- 説明書.pdf: このドキュメント

## 4. プログラムのインストール方法
### ダウンロードと展開
- 配布ファイルの取得: 配布されたファイルをすべてダウンロードしてください。「先着予約自動化」をフォルダごとダウンロードすることをオススメします。  
- ファイルの展開: フォルダごとダウンロードした場合に必要です。ダウンロードしたZIPファイルを右クリックし、「すべて展開」を選択して適当なフォルダに展開します。  
- フォルダの確認: 展開されたフォルダ内に「情報入力.exe」、「予約実行.exe」、`reservation.db`があることを確認してください。実行する際には、3つのファイルはすべて同じディレクトリ(フォルダ)に配置しておいて下さい。(`reservation.db`は含まれていないこともあります。その場合は心配ないです。)  

### 実行前の確認
Windowsによってセキュリティ警告が表示される場合がありますが、その場合は「詳細情報」をクリックして「実行」を選択してください。

## 5. 情報入力.exeの使用方法
### プログラムの起動
- 実行ファイルの起動: `情報入力.exe`をダブルクリックして起動します。  
- セキュリティ警告への対応: Windowsのセキュリティが警告を表示した場合は、実行を許可してください。  

### 情報入力の項目について
- **User ID**: コートカードのユーザーIDを入力します。  
これはユーザー固有の識別子として使われ、予約を区別するために重要です。  
- **Password**: コートカードのパスワードを入力します。  
パスワードは入力内容が隠れない形式ですが、予約の際に必要な情報です。  
- **Park（公園の選択）**: 「岡崎」または「宝」から選択します。  
予約したいテニスコートを選択してください。岡崎と宝のみ対応しています。  

### 予約日と時間帯の選択
- **日付の選択**: カレンダーから予約したい日付をクリックして選択します。  
カレンダーをクリックし、予約したい日付を指定します。複数の日付を選ぶこともできます。  
- **時間帯の選択**: ドロップダウンメニューから、希望する時間帯（例: 8~10, 10~12など）を選択します。  
各日付に対して予約したい時間帯を選んでください。  

### 追加
- 「Add Date & Time Slot」ボタンを押すことで、複数の予約をリストに追加します。  
追加した日付と時間帯はリストに表示されます。  

### データの保存
すべての入力が完了したら、「Save All」ボタンを押して、データベースに情報を保存します。これにより、予約情報がデータベースに登録され、次回予約実行時に利用されます。

## 6. データベース確認・編集・削除の使い方
### プログラムの起動
`情報入力.exe`を起動した後、メニューから「データベース確認・編集・削除」オプションを選択します。  

### データベースの内容確認
プログラムが現在保存されている予約情報とユーザー情報を一覧で表示します。  
User ID、日付、時間帯、予約ステータス（予約が完了しているか、未完了であるかなど）を見ることができます。

### 編集
編集したい項目を選択し、**「編集」**ボタンを押すと、編集画面が表示されます。  
User ID、日付、時間帯、予約ステータスを変更し、**「保存」**ボタンを押します。  
変更内容がデータベースに反映され、再度実行する際には更新された情報が使用されます。

### 削除
削除したい行を選択し、「削除」ボタンを押します。  
削除を実行する前に、確認メッセージが表示されますので、「はい」を選択すると予約が削除されます。  
予約を削除しても、他の予約があればそのまま残りますが、すべての予約が削除されたユーザーは、自動的にUsersテーブルからも削除されます。

## 7. 予約実行.exeの使用方法
### 予約の実行
- **実行ファイルの起動**: `予約実行.exe`をダブルクリックして起動します。  
- **予約の実行プロセス**: プログラムが自動で予約を実行し、結果を表示します。  
- **成功またはエラーメッセージの確認**: 予約の実行結果が表示されます。  

### 注意事項
予約がうまく実行されなかった場合は、再度「情報入力.exe」で正しい情報を入力してから「予約実行.exe」を実行してください。

## 8. エラーメッセージと対処法
### よくあるエラー:
- **「ユーザー情報が正しくありません」**: ユーザーIDやパスワードが間違っている可能性があります。再確認して入力してください。  
- **「予約が埋まっています」**: 予約可能な時間帯が埋まっているため、別の時間帯を選んでください。  

### トラブルシューティング:
- 予約が成功しない場合、インターネット接続を確認してください。  
- 問題が解決しない場合は、サポート情報を参照してください。

## 9. プログラムの更新方法
### 新しいバージョンの取得
開発者から配布された新しいバージョンがある場合、同じ手順でダウンロードして展開します。

### アップデート手順
現在のプログラムとデータベースを削除せずに、新しいファイルを同じフォルダに上書きしてください。  
データベース（`reservation.db`）はそのまま利用可能です。

## 10. データの管理
### データベースの役割
`reservation.db`は、ユーザー情報や予約情報を保存するファイルです。このファイルを削除すると、保存したデータが消えてしまいますのでご注意ください。

### バックアップと復元
- **バックアップ**: `reservation.db`ファイルを定期的にコピーして別のフォルダに保存しておくことをお勧めします。  
- **復元**: もしデータベースが破損した場合、バックアップしたファイルを元の場所に戻すことで復元できます。

## 11. アンインストール方法
### プログラムの削除
- プログラムが保存されているフォルダを開きます。  
- 「情報入力.exe」、「予約実行.exe」、および`reservation.db`ファイルを右クリックし、「削除」を選択します。  

### データベースファイルの削除
データベースファイル（`reservation.db`）も一緒に削除する場合、バックアップがないとデータが消えてしまうため、注意してください。

## 12. サポート情報
### お問い合わせ
技術的な問題やプログラムの使用に関する質問がある場合、以下の連絡先にお問い合わせください。対応できない場合もあります。  
サポートメール: yutonakaoka13@gmail.com  

### よくある質問（FAQ）
- **Q: 予約が実行されません。どうすればいいですか？**  
A: インターネット接続を確認し、正しいユーザー情報が入力されているか再確認してください。  

- **Q: macOSでも使いたいです。どうすればいいですか？**  
A: Github上でソースコードを公開しています。pythonの実行環境があり、知見がある方はappファイルを作成してご活用ください。また、Wineというツールを用いると、macOSでもEXEファイルが実行できるようです。  
参考：[github url](https://github.com/NAKAch/first_come_reservation)[wineをmacOSで実行する](https://frontl1ne.net/2019/08/run-windows-application-on-unix-with-wine/)

## 13. 免責事項
本プログラムは、ユーザーの利便性を目的として提供されていますが、使用に伴う結果について、作成者は一切の責任を負いません。プログラムの動作や結果において生じた損害や不利益について、作成者は何ら補償を行わないものとします。  
本プログラムを使用することにより、ユーザーはこの免責事項に同意したものとみなされます。
